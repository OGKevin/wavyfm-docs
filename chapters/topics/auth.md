All requests to the wavy.fm API need to be authenticated. Each request must use one of the two available methods
(we call them "flows") to authenticate:

- **Client Credentials**: Authenticates your app, but not a user. With this flow, you can only access public
  information, such as public profiles and global metrics.
- **Authorization Code**: Authenticates your app, with the permission of a wavy.fm user to interact with their account.
  The user will be prompted for confirmation of the APIs (scopes) you intend to use. For example, you can retrieve their
  profile even if it is private, as long as they permitted it.
- **Desktop Authorization**: Similar to the Authorization Code flow, but specifically designed for accessing APIs from
  desktop applications and the like.

> At the moment, only the **Client Credentials** flow is supported in the latest API version (v1beta).

Each flow has its corresponding use-cases. Some endpoints will only work with specific flows; this will be specified in
the endpoint's documentation.

In this guide, we will cover all authentication flows from scratch by demonstrating with Bash and cURL commands.
This is good for gaining a deeper understanding, but we highly recommend you use a **[client library](../intro/client-libraries)**
instead of implementing this yourself. You should refer to the client library's documentation to properly authenticate.

## Client Credentials

**Client Credentials** is the simplest flow to implement, but it limits you to APIs that provide public information,
such as public profiles and global metrics. It is formally defined in
the [OAuth 2.0 specification](https://tools.ietf.org/html/rfc6749#section-4.4).

To use the Client Credentials flow, you must [create an application](../../apps) and obtain a **Client ID** and
a **Client Secret**. It is fundamental that the Client Secret stays _secret_, and should never be sent to end-users. If you
suspect your Client Secret was leaked, you can regenerate it from the app dashboard.

A **Client ID** as the form `pub_XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX`, and a **Client Secret** has the form
`priv_XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX`. Each `X` is a hexadecimal digit (`0-f`).

The first step of the Client Credentials flow is to request an access token from
the [token endpoint](../v1beta/auth#token), with the `Authorization` header generated by:

1. Concatenating the Client ID and Client Secret with a colon (`:`) in the middle, then
2. encoding the resulting text in Base-64, then
3. prefixing with `Basic `

```bash
# Bash

# Step 1
client_id='pub_XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'
client_secret='priv_XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX'
concat="$client_id:$client_secret"

# Step 2
encoded="$(echo -n "$concat" | base64 -w 0)"

# Step 3
authorization="Basic $encoded"
```

Now, we can request the temporary access token via cURL:

```bash
# Bash with cURL, using the `$authorization` variable from the previous script

curl -Ls https://wavy.fm/api/v1beta/token \
  -X POST \
  -H "Authorization: $authorization" \
  -H "Accept: application/json" \
  -F "grant_type=client_credentials"
```

If successful, you should receive a JSON response like this:

```json
{
  "access_token": "...",
  "token_type": "bearer",
  "expires_in": 3600
}
```

> N.B: The `expires_in` field is in seconds.

From now on, you can make requests with the given `access_token` as your `Authorization` header. Note that you should
prefix it with `Bearer ` every time.

For example, to [get the total amount of listens](../v1beta/metrics#total-listens) on wavy.fm:

```bash
# Bash with cURL
access_token='...' # This is the `access_token` from the previous response

curl -Ls https://wavy.fm/api/v1beta/metrics/total-listens \
  -X GET \
  -H "Authorization: Bearer $access_token"
  -H "Accept: application/json"
# Outputs 17711893
```

This access token is valid for 1 hour, you must request a new one to continue making requests after it expires.
